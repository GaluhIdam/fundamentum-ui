<div class="fui-flex-combox-parent">
  <fui-popover [position]="'bottom'">
    <fui-form-control-layout>
      <fui-input-field
        (onFocus)="toggleOpenSelectorFocus()"
        [type]="'text'"
        [formControlField]="comboxForm"
        [placeholder]="placeholder"
        [size]="size"
        [invalid]="invalid"
      >
        <fui-icons
          *ngIf="leftIcon"
          left-icon
          [icon]="leftIcon"
          [size]="'size' + size"
        ></fui-icons>
        <div left-icon *ngIf="!singleSelection">
          <span class="badge" *ngFor="let data of selectedValue">
            {{ data.name }}
            <fui-icons
              (click)="toggleSelection(data)"
              [icon]="'cross'"
              [size]="'sizexs'"
            />
          </span>
        </div>
        <fui-icons
          style="margin-right: 8px"
          *ngIf="invalid"
          right-icon
          [label]="'right'"
          [icon]="'alert'"
          [size]="'size' + size"
          [color]="'danger'"
        />
        <fui-icons
          style="margin-right: 8px"
          right-icon
          *ngIf="selectedValue.length > 0"
          (click)="toggleClearData()"
          [icon]="'cross'"
          [size]="'sizexs'"
        ></fui-icons>
        <fui-icons
          right-icon
          (click)="toggleOpenSelector()"
          class="fui-icon-combox"
          [icon]="'arrowDown'"
          [size]="'size' + size"
        ></fui-icons>
      </fui-input-field>
      <fui-validator-field validator [message]="message" />
    </fui-form-control-layout>
    <div popover-body>
      <div
        *ngIf="openSelector"
        [attr.multiple]="!singleSelection"
        class="fui-multi-select {{ selectedValue.length <= 4 ? 'mini' : '' }}"
      >
        @for(item of optionValue; track $index; let last = $last;) {
        <div>
          <div
            class="fui-option-select {{
              isSelected(item) ? 'option-selected' : ''
            }}"
            *ngIf="
              item.name.toLowerCase().includes(comboxForm.value!.toLowerCase())
            "
            [value]="item.value"
            (click)="toggleSelection(item)"
          >
            {{ item.name }}
          </div>
        </div>
        }
        <p
          style="text-align: center; font-size: small; margin-top: 10px"
          *ngIf="optionValue.length === 0"
        >
          Option is not available!
        </p>
      </div>
    </div>
  </fui-popover>
</div>
